

<script>
    function getGridParam() {
        var OfficeID = 0;
        var Year = 0;
        OfficeID = $("#offs").val();
        Year = $("#ddlYear").val();
        return {
            OfficeID: OfficeID,
            YearOf: Year
        }
    }   
    function ReqReturn(ProposedItemID) {
        var url = "@Url.Action("CheckIfVerifiedByOtherLevel", "Home")";
        $.get(url, { ProposedItemID: ProposedItemID }, function (d) {
            if (d != 1) {
                swal({
                    title: "Are you sure?",
                    text: "This Action Will Automatically Mark the selected item as Not-Verified.",
                    type: "info",
                    showCancelButton: true,
                    confirmButtonColor: "#DD6B55",
                    confirmButtonText: "Yes!",
                    closeOnConfirm: false
                }, function () {
                    var url = "@Url.Action("MarkUnVerified", "Home")";
                    $.get(url, { ProposedItemID: ProposedItemID}, function (d) {
                        if (d == 1) {
                            swal({
                                title: "Success!",
                                text: "Succesffuly Returned.",
                                type: "success",
                                timer: 2000,
                                showConfirmButton: false
                            });
                            $("#grProposedPositionListVerified").data("kendoGrid").dataSource.read();
                        }
                        else {
                            swal({
                                title: "Error!",
                                text: d,
                                type: "error",
                                timer: 2000,
                                showConfirmButton: false
                            });
                        }
                    });
                });
            }
            else {
                swal({
                    title: "Cannot Complete Request!",
                    text: "This Position Has Been Verified by the Other Office Level",
                    type: "error",
                    timer: 2000,
                    showConfirmButton: false
                });
            }
        });
        
    }
</script>
@(Html.Kendo().Grid<iFMIS_BMS.BusinessLayer.Models.ForFundingModel>()
        .Name("grProposedPositionListVerified")
        .Columns(columns =>
        {
            columns.Bound(c => c.GroupBY).Title("Group").Hidden()
                .ClientGroupHeaderTemplate("<div style='display:inline-block'>#= value #</div>");
            columns.Bound(c => c.ProposedItemID).Hidden();
            columns.Template(@<text></text>)
                        .HtmlAttributes(new { style = "text-align:left;height:30px" }).HeaderTemplate(@<text><div style="font-weight:600;text-align:center; vertical-align: middle; overflow: visible; white-space: normal;">Position</div></text>)
                        .Width(170)
                        .HeaderHtmlAttributes(new { style = "text-align:center; vertical-align: middle; overflow: visible; white-space: normal" })
                        .ClientTemplate(
                            "# if(GroupBY == 'Proposed Position') { #" +
                            " <span class='fa fa-circle' style='color:green;' id='circle-id'></span> #=Position#" +
                            "# } else { #" +
                            " <span class='fa fa-circle' style='color:yellow;' id='circle-id'></span> #=Position#" +
                            "# } #"
                        );

            columns.Template(@<text></text>)
                        .HtmlAttributes(new { style = "text-align:left;height:30px" }).HeaderTemplate(@<text><div style="font-weight:600;text-align:center; vertical-align: middle; overflow: visible; white-space: normal;">Salary Grade</div></text>)
                        .Width(50)
                        .HeaderHtmlAttributes(new { style = "text-align:center; vertical-align: middle; overflow: visible; white-space: normal" })
                        .ClientTemplate("<div>#=SG# </div>");

            columns.Template(@<text></text>)
                        .HtmlAttributes(new { style = "text-align:left;height:30px" }).HeaderTemplate(@<text><div style="font-weight:600;text-align:center; vertical-align: middle; overflow: visible; white-space: normal;">Salary</div></text>)
                        .Width(60)
                        .HeaderHtmlAttributes(new { style = "text-align:center; vertical-align: middle; overflow: visible; white-space: normal" })
                        .ClientTemplate("<div>#=kendo.toString(Salary,'c2')# </div>");
                        
            columns.Template(@<text></text>)
                        .HtmlAttributes(new { style = "text-align:left;height:30px" }).HeaderTemplate(@<text><div style="font-weight:600;text-align:center; vertical-align: middle; overflow: visible; white-space: normal;">Specification</div></text>)
                        .Width(80)
                        .HeaderHtmlAttributes(new { style = "text-align:center; vertical-align: middle; overflow: visible; white-space: normal" })
                        .ClientTemplate("<div>#=GroupTag# </div>");


            columns.Template(@<text></text>)
                        .HtmlAttributes(new { style = "text-align:left;height:30px" }).HeaderTemplate(@<text><div style="font-weight:600;text-align:center; vertical-align: middle; overflow: visible; white-space: normal;">Remark</div></text>)
                        .Width(80)
                        .HeaderHtmlAttributes(new { style = "text-align:center; vertical-align: middle; overflow: visible; white-space: normal" })
                        .ClientTemplate("<div>#=Remark# </div>");
                        
                columns.Template(t => { }).ClientTemplate(
                  "<div class='k-button' onclick='ReqReturn(#=ProposedItemID#)' style='inline-block' title='Return'>Return</div>"
                  ).Width(150);
        })
        .HtmlAttributes(new { style = "height: 500px;" })
        .Scrollable(s => s.Enabled(true))
        .Selectable()
        .Editable(editable => editable.Mode(GridEditMode.InCell))
        .Pageable(page => page.Refresh(true)
                                 .Enabled(true)
                                 .ButtonCount(4)
                                 .PreviousNext(true)
                  )
        .DataSource(dataSource => dataSource
            .Ajax()
            .Batch(true)
            .ServerOperation(false)
            .Model(m => m.Id(i => i.ProposedItemID))
            .Read(read => read.Action("grGetProposedVerifiedPosition", "Home").Data("getGridParam"))
        )
)
