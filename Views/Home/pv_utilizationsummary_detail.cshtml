<script>
    function fn_paramdetails() {
        return {
            officeid: '@Session["officeid"]',
            proyear: '@Session["proyear"]',
            ooe:'@Session["ooeid"]'
        }
    }
    function searchaccount_uti() {
        var $filter = new Array();
        $filter = [];

        if ($('#SearchData_uti').val().length > 0) {
            $filter.push({ field: "AccountName", operator: "contains", value: $('#SearchData_uti').val() });
        }

        $('#grd_utilizationsum_detail').data('kendoGrid').dataSource.filter({
            logic: "or",
            filters: $filter
        });
    }

    $(function () {
        $("#SearchData_uti").keypress(function (e) {
            if (e.keyCode == 13) {
                searchaccount_uti();
            }
        });
    });
</script>
<div id="searchAccountid" style="height: 30px; margin-top: 0px; float: right; margin-left: 200px;">
    <input type="text" style="width:400px;border-collapse:collapse;margin:0px;border-style:solid;border-color:black;margin-left:0px;height:70%;outline:none;font-family:'Segoe UI Light_','Open Sans Light',Verdana,Arial,Helvetica,sans-serif;float:left;" placeholder="Search account..." id="SearchData_uti" name="SearchData_uti">
    <div class="k-button k-button-icontext" style="height:30px;width:40px;border-style:solid;border-color:black;" onclick="searchaccount_uti()"><span class="mif-search"></span></div>
</div>
<div style="margin-top:35px;">
    @(Html.Kendo().Grid<iFMIS_BMS.BusinessLayer.Models.BudgetControlModel>()
        .Name("grd_utilizationsum_detail")
        .HtmlAttributes(new { style = "height:550px;" })
        .Scrollable()
    .Columns(col =>
    {
    col.Template(@<text></text>)
                    .HeaderTemplate(@<text><div style="font-weight:600;">Account</div></text>)
                        .Width(270)
                        .HtmlAttributes(new { style = "text-align:left;height:30px" })
                        .HeaderHtmlAttributes(new { style = "text-align:center; vertical-align: middle; overflow: visible; white-space: normal" })
                        .ClientTemplate("<div>#=AccountName# </div>")
                        .ClientFooterTemplate("<div style='text-align:center;font-weight:bold'> TOTAL </div>");
        col.Bound(m => m.app1)
                    .HtmlAttributes(new { style = "font-weight:600;text-align:right; vertical-align: middle; overflow: visible; white-space: normal;" })
                    .HeaderTemplate(@<text><div style="font-weight:600;text-align:center; vertical-align: middle; overflow: visible; white-space: normal;">Appropriation <br /> 2021</div></text>    )
                    .HeaderHtmlAttributes(new { style = "text-align:center" })
                    .Width(130)
                    .ClientTemplate("<div>#=kendo.toString(app1,'c2')# </div>")
                    .ClientFooterTemplate("<div style='text-align:right;color:darkgreen'><label> </label><label> #=kendo.toString(sum, 'c2')#</label></div>");
        col.Bound(m => m.allot1)
                    .HtmlAttributes(new { style = "font-weight:600;text-align:right; vertical-align: middle; overflow: visible; white-space: normal;" })
                    .HeaderTemplate(@<text><div style="font-weight:600;text-align:center; vertical-align: middle; overflow: visible; white-space: normal;">Allotment <br /> 2021</div></text>    )
                    .HeaderHtmlAttributes(new { style = "text-align:center" })
                    .Width(130)
                    .ClientTemplate("<div>#=kendo.toString(allot1,'c2')# </div>")
                    .ClientFooterTemplate("<div style='text-align:right;color:darkgreen'><label> </label><label> #=kendo.toString(sum, 'c2')#</label></div>");
        col.Bound(m => m.obligate1)
                        .HtmlAttributes(new { style = "font-weight:600;text-align:right; vertical-align: middle; overflow: visible; white-space: normal;" })
                        .HeaderTemplate(@<text><div style="font-weight:600;text-align:center; vertical-align: middle; overflow: visible; white-space: normal;">Obligation <br /> 2021</div></text>    )
                    .HeaderHtmlAttributes(new { style = "text-align:center" })
                    .Width(130)
                    .ClientTemplate("<div>#=kendo.toString(obligate1,'c2')# </div>")
                    .ClientFooterTemplate("<div style='text-align:right;color:darkgreen'><label> </label><label> #=kendo.toString(sum, 'c2')#</label></div>");
        col.Bound(m => m.app_per1)
                        .HtmlAttributes(new { style = "font-weight:600;text-align:center; vertical-align: middle; overflow: visible; white-space: normal;background-color:cornflowerblue;color:white" })
                        .HeaderTemplate(@<text><div style="font-weight:600;text-align:center; vertical-align: middle; overflow: visible; white-space: normal;">Appropriation Pct. <br /> 2021</div></text>    )
                    .HeaderHtmlAttributes(new { style = "text-align:center;background-color:cornflowerblue;color:white" })
                    .Width(130)
                    .ClientTemplate("<div>#=kendo.toString(app_per1,'N2')#%</div>");
        col.Bound(m => m.allot_per1)
                        .HtmlAttributes(new { style = "font-weight:600;text-align:center; vertical-align: middle; overflow: visible; white-space: normal;background-color:chocolate;color:white" })
                        .HeaderTemplate(@<text><div style="font-weight:600;text-align:center; vertical-align: middle; overflow: visible; white-space: normal;">Allotment Pct. <br /> 2021</div></text>    )
                    .HeaderHtmlAttributes(new { style = "text-align:center;background-color:chocolate;color:white" })
                    .Width(130)
                    .ClientTemplate("<div>#=kendo.toString(allot_per1,'N2')#% </div>");

        col.Bound(m => m.OfficeID).Title("office").Hidden();
        col.Bound(m => m.ooeid_uti).Title("ooe ID").Hidden();


        //

    })
         .AutoBind(false)
         .Pageable(page => page.Refresh(true)
            .Enabled(true)
            .ButtonCount(4)
            .PreviousNext(true)
         )
         // .ClientDetailTemplateId("template_table")
         .Selectable()
           //.Events(e => e.Change("onGridEdit"))

           .Scrollable()

         .DataSource(d => d
         .Ajax()
         .Batch(true)
         .ServerOperation(false)
         .Aggregates(a =>
         {
             a.Add(c => c.app1).Sum();
             a.Add(c => c.allot1).Sum();
             a.Add(c => c.obligate1).Sum();
         })
         .PageSize(8)
         .Model(m => m.Id(i => i.ooeid_uti))
         .Read(read => read.Action("proposal_utilizationsum_detail", "Home").Data("fn_paramdetails"))
         )
    )
</div>
<script>
        $(document).ready(function () {
            $("#grd_utilizationsum_detail").data("kendoGrid").dataSource.read()
        });

</script>