<script>
    function newAccount() {
        $(window).scrollTop(0);
        var url = "@Url.Action("newAccounts", "Annual")";
        //ProgramID = e;
        $.get(url, function (d) {
            //alert(ProgramID);
            $('#newAccounts').html(d);
        })
        $('#newAccounts').data('kendoWindow').title("Create New Accounts").center().open();
    }
</script>
<script type="text/javascript">

    var BudgetYear = $("#propsYears").val();
    var PastYear = BudgetYear - 2;
    var CurrentYear = BudgetYear - 1;
    document.getElementById("actualYearAppropriate").innerHTML = PastYear;
    document.getElementById("estimatesYearAppropriate").innerHTML = CurrentYear;
    document.getElementById("proposedYearAppropriate    ").innerHTML = BudgetYear;

</script>


<div style="border: outset;border-width:1px;border-color:#038603; width: 870px; padding-left:0px;padding-right:0px;padding-top:0px;padding-bottom:7px;margin-top: 10px;">
    <div style=" width: 0;height: 0; border-right: 5px solid #333333; border-bottom: 37px solid #333333; border-left: 65px solid #333333;margin-top: -1px; ">
        <div style="width: 803px; margin-top:1px;margin-bottom:-97px;margin-left:-33px; height: 0; border-left: 35px solid #333333; border-bottom: 37px solid #1fa67a; ">

            <div style="float: left; height:28px; margin-left:-59px; margin-top: 5px;">
                <i class="fa fa-tasks fa-2x fg-white"> &nbsp;&nbsp;</i>
            </div>
            <div style="float:right;margin-right:6px;margin-top:5px;">
                <button class="k-button k-button-icontext" onclick="newAccount()"> <i class="fa fa-plus-circle"></i> Create New Account</button>
            </div>
        </div>
    </div>


    <script>

        function fn_Program1() {

            var grid = $('#AccountsGrid').data('kendoGrid');



            var proYe = $("#propsYears").val();
            return {

                propYear1: proYe

            }
            dataBound: gridDataBound

        }
        function ssss() {



            @*var url = "@Url.Action("updateAccounts", "Annual")";*@
            swal(
                "Success!", "Sucessfully save", "success");
        }

        function gridDataBound(e) {
            var grid = e.sender;
            if (grid.dataSource.total() == 0) {
                var colCount = grid.columns.length;
                $(e.sender.wrapper)
                    .find('tbody')
                    .append('<tr class="kendo-data-row"><td colspan="' + colCount + '" class="no-data">Sorry, no data :(</td></tr>');
            }
        };


        function onGridEdit(arg) {
            if (arg.container.find("input[name=PastProposalAmmount]").length > 0) {

                $("#AccountsGrid").data("kendoGrid").closeCell(arg.container)
            }
        }



    </script>



    @(Html.Kendo().Grid<iFMIS_BMS.BusinessLayer.Models.AccountsModel>()
    .Name("AccountsGrid")

    .Columns(col =>
    {
        col.Template(@<text></text>)
                        .HeaderTemplate(@<text><div style="font-weight:600;">Accounts</div></text>)
                        .Width(150)
                        .HtmlAttributes(new { style = "text-align:left" })
                        .HeaderHtmlAttributes(new { style = "text-align:center" })
                        .ClientTemplate("<div>#=AccountName# </div>").Width(240);


        col.Template(@<text></text>)
                        .HeaderTemplate(@<text><div style="font-weight:600;">Account Code</div></text>)
                        .Width(150)
                        .HtmlAttributes(new { style = "text-align:left" })
                        .HeaderHtmlAttributes(new { style = "text-align:center" })
                        .ClientTemplate("<div>#=OOEName# </div>").Width(10);


        @*col.Template(@<text></text>)
                        .HeaderTemplate(@<text><div style="font-weight:600;text-align:center; vertical-align: middle; overflow: visible; white-space: normal;">Past Year <span id="actualYearAppropriate"></span>  (Actual)</div></text>)
                        .Width(110)
                        .HtmlAttributes(new { style = "text-align:left" })
                        .HeaderHtmlAttributes(new { style = "text-align:center" })
                        .ClientTemplate("<div>#=PastProposalYear# </div>").Width(29);*@

                        @*col.Template(@<text></text>)
                            .HeaderTemplate(@<text><div style="font-weight:600;">Funds</div></text>)
                            .Width(150)
                            .HtmlAttributes(new { style = "text-align:left" })
                            .HeaderHtmlAttributes(new { style = "text-align:center" })
                            .ClientTemplate("<div>#=PastProposalAmmount# </div>").Width(140);*@
        col.Bound(m => m.PastProposalAmmount).HtmlAttributes(new { style = "text-align:left;" })
                        .HeaderTemplate(@<text><div style="font-weight:600;text-align:center; vertical-align: middle; overflow: visible; white-space: normal;">Past Year <span id="actualYearAppropriate"></span>  (Actual)</div></text>)
                        .HeaderHtmlAttributes(new { style = "text-align:center" }).Width(60);

        col.Template(@<text></text>)
                        .HeaderTemplate(@<text><div style="font-weight:600;text-align:center; vertical-align: middle; overflow: visible; white-space: normal;">Current Year <span id="estimatesYearAppropriate"></span>   (Estimates)</div></text>)
                        .Width(150)
                        .HtmlAttributes(new { style = "text-align:left" })
                        .HeaderHtmlAttributes(new { style = "text-align:center" })
                        .ClientTemplate("<div>#=ProposalYear# </div>").Width(50);

        col.Bound(m => m.ProposalAllotedAmount).HtmlAttributes(new { style = "text-align:left;" })
            .HeaderTemplate(@<text><div style="font-weight:600;text-align:center; vertical-align: middle; overflow: visible; white-space: normal;">Budget Year <span id="proposedYearAppropriate"></span> (Proposed)</div></text>)
            .HeaderHtmlAttributes(new { style = "text-align:center" }).Width(90);




    })
                                            .ToolBar(toolbar =>
                                   {

                                       toolbar.Save();
                                   })
                                                     .Editable(editable => editable.Mode(GridEditMode.InCell))
                                                     .Pageable(page => page.Refresh(true)
                                                                     .Enabled(true)
                                                                     .ButtonCount(4)
                                                                     .PreviousNext(true)
                                                                         )
                                                                               .Events(e => e.SaveChanges("ssss").Edit("onGridEdit"))
                                                                               .Selectable()
                                                                               .DataSource(d => d
                                                                               .Ajax()
                                                                               .Batch(true)
                                                                               .PageSize(10)
                                                                               .Model(m => m.Id(i => i.AccountID))
                                                                               .Read(read => read.Action("Prog_read1", "Annual").Data("fn_Program1"))
                                                                                       .Update("_updateHome2", "Annual"))
)
</div>


@(Html.Kendo().Window()
    .Name("newAccounts")
    .Title("Create New Accounts")
    .Width(850)
    .Height(510)
    .Visible(false)
    .Modal(true)
    .Draggable(false)
    .AutoFocus(true)
    .Animation(a => 
        { a.Open(o => o.SlideIn(SlideDirection.Down)); 
            a.Close(c => { c.SlideIn(SlideDirection.Down); 
                c.Reverse(true); 
            }); 
        }).Actions(a => { a.Close(); }))